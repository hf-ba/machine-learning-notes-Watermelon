# 第二章 模型评估与选择
## 2.1 经验误差与过拟合
过拟合vs欠拟合

![image](https://github.com/user-attachments/assets/eac9e47e-e89d-4b1c-a19b-aa65d2975002)

![image](https://github.com/user-attachments/assets/5c015e98-8482-478b-8590-edfd2dc959ab)

## 2.2 评估方法
首先要区分测试机与训练集，有三种方法
### 方法一 留出法

直接区分为两个互斥的集合，需要注意：

- 训练/测试集的划分要尽可能保持数据分布的一致性，可以采用分层采样
- 即便在给定训练/测试集的样本比例后，仍存在多种划分方式对初始数据集进行分割。因此，单次使用留出法得到的估计结果往往不够稳定可靠,在使用留出法时，一般要采用若干次随机划分、重复进行实验评估后取平均值作留出法的评估结果
- 常见做法是将大约2/3-4/5的样本用于训练，剩余样本用于测试

### 方法二 交叉验证法
示意图如下：

![image](https://github.com/user-attachments/assets/74a1384f-5249-4208-a927-757eac568698)

需要注意的是：也需要进行多次取平均值。

当如果一共有m个样本，k=m时为**留一法**。好处是：
- 几乎用到了所有数据，评估结果更可靠。
- 特别适合小数据集，避免了数据浪费。（但是对于大数据集来说计算开销过大）
- 无随机性，结果稳定。

适用于数据量较小（比如几十到几百个样本）或需要高精度的模型评估。

### 方法三 自助法

自助法是一种从数据集中随机抽取样本的方法，用来创建训练集和测试集。它的核心思想是通过有放回地随机抽样来生成多个不同的数据集，从而评估模型的性能。
具体步骤
有放回地随机抽样：

- 假设你有一个包含N个样本的数据集。从这 N个样本中随机抽取一个样本，记录后放回数据集。
- 重复这个过程 N次，得到一个新的数据集（训练集）。
- 由于是有放回抽样，有些样本可能会被抽到多次，而有些样本可能一次都没被抽到。并且把从来没抽到的设置为测试集。

说明：从来没被抽中的概率如下：

![image](https://github.com/user-attachments/assets/4bb00c57-06a6-49c4-aa58-bc9b1a1ab80d)

通过该方法我们仍有数据总量约1/3的、没在训练集中出现的样本用于测试。这样的测试结果，亦称 “包外估计”。

#### 举例
- 假设你有 5 个苹果，编号为 1、2、3、4、5。
- 你随机抽取 5 次（每次抽完放回），可能得到这样的结果：1、3、3、5、2。
- 训练集：1、2、3、3、5（注意，3 被抽到了两次）。
- 测试集：4（因为 4 没有被抽到）。

自助法的特点：
- 当数据量很少时，自助法可以生成多个不同的训练集，充分利用数据
- 自助法产生的数据集改变了初始数据集的分布，这会引入估计偏差

### 调参与最终模型


